<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fc24 SBC</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Squad Building Challenges</h1>
    
    <!-- Display the user's collection of player cards -->
    <h2>Your Player Collection</h2>
    <div id="club-images">
        <!-- Display stored unique images from localStorage -->
        <script>
            const storedImagesJSON = localStorage.getItem('storedImages');
            if (storedImagesJSON) {
                const storedImages = JSON.parse(storedImagesJSON);
                const uniqueImages = [...new Set(storedImages)]; // Remove duplicates using a Set
                const clubImages = document.getElementById('club-images');

                uniqueImages.forEach((imageURL) => {
                    const image = document.createElement('img');
                    image.src = imageURL;
                    clubImages.appendChild(image);
                });
            }
        </script>
    </div>

    <!-- List available SBC challenges -->
    <h2>Available SBC Challenges</h2>
    <ul id="sbc-challenges">
        <li>
            Challenge 1: Collect 10 ICON Players <!-- Updated challenge name -->
            <button onclick="completeSBC('Challenge 3', 10)">Complete</button> <!-- Updated requiredPlayers value -->
        </li>
    </ul>

    <!-- Link back to the pack opener -->
    <a href="index.html">Back to Pack Opener</a>

    <script>
        // Modify the storedImages array to include player objects with a "category" property
        const storedImages = JSON.parse(localStorage.getItem('storedImages')) || [];

        // Function to update the player collection in local storage
        function updatePlayerCollection() {
            localStorage.setItem('storedImages', JSON.stringify(storedImages)); // Update 'storedImages' in local storage
        }

        // Function to complete an SBC challenge
        function completeSBC(challengeName, requiredPlayers) {
            // Check if the user has enough ICON players for the challenge
            const iconPlayersMatchingCategory = storedImages.filter(image => image.includes('Cards/Icons/'));

            if (iconPlayersMatchingCategory.length >= requiredPlayers) {
                // Remove the required ICON players from the collection
                for (let i = 0; i < requiredPlayers; i++) {
                    const index = storedImages.findIndex(image => image.includes('Cards/Icons/'));
                    storedImages.splice(index, 1);
                }

                // Reward the user (for simplicity, just add a "reward" to the collection)
                storedImages.push({ name: `${challengeName} Reward` });

                // Update the player collection in local storage
                updatePlayerCollection();

                // Display a success message (you can improve this part)
                alert(`SBC Challenge "${challengeName}" completed! You received a reward.`);
            } else {
                // Display an error message if the user doesn't meet the requirements
                alert(`You don't have enough ICON players to complete "${challengeName}".`);
            }

            // Refresh the UI to reflect the changes
            displayPlayerCollection();
        }

        // Function to display the user's player collection
        function displayPlayerCollection() {
            const playerCollectionList = document.getElementById('player-collection');
            playerCollectionList.innerHTML = '';

            storedImages.forEach((player) => { // Use storedImages here
                const listItem = document.createElement('li');
                listItem.textContent = player.name;
                playerCollectionList.appendChild(listItem);
            });
        }

        // Initialize the UI with the user's player collection
        displayPlayerCollection();
    </script>
</body>
</html>
