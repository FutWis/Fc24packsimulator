<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fc24 SBC</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>Squad Building Challenges</h1>
    
    <!-- Display the user's collection of player cards -->
    <h2>Your Player Collection</h2>
    <div id="club-images">
        <!-- Display stored unique images from localStorage -->
        <script>
            const storedImagesJSON = localStorage.getItem('storedImages');
            if (storedImagesJSON) {
                const storedImages = JSON.parse(storedImagesJSON);
                const uniqueImages = [...new Set(storedImages)]; // Remove duplicates using a Set
                const clubImages = document.getElementById('club-images');

                uniqueImages.forEach((imageName) => {
    // Construct the complete image URL relative to the current page's location
    const imageURL = imageName; // If the images are in the same directory

    const image = document.createElement('img');
    image.src = imageURL;
    clubImages.appendChild(image);
});

            }
        </script>
    </div>

    <!-- List available SBC challenges -->
    <h2>Available SBC Challenges</h2>
    <ul id="sbc-challenges">
        <li>
            Challenge 1: Collect 10 ICON Players <!-- Updated challenge name -->
            <button onclick="completeSBC('Challenge 1', 10)">Complete</button> <!-- Updated requiredPlayers value -->
        </li>
    </ul>

    <!-- Reward image container -->
    <div id="reward-container" style="display: none;">
        <h2>Reward</h2>
        <img id="reward-image" src="" alt="Reward">
    </div>

    <!-- Link back to the pack opener -->
    <a href="index.html">Back to Pack Opener</a>

    <script>
        // Modify the storedImages array to include player objects with a "category" property
        const storedImages = JSON.parse(localStorage.getItem('storedImages')) || [];

        // Function to update the player collection in local storage
        function updatePlayerCollection() {
            localStorage.setItem('storedImages', JSON.stringify(storedImages));
        }

        // Function to complete an SBC challenge
        function completeSBC(challengeName, requiredPlayers) {
            // Check if the user has enough ICON players for the challenge
            const iconPlayersMatchingCategory = storedImages.filter(player => player.imageURL && player.imageURL.includes('Cards/Icons/'));

            if (iconPlayersMatchingCategory.length >= requiredPlayers) {
                // Remove the required ICON players from the collection
                for (let i = 0; i < requiredPlayers; i++) {
                    const index = storedImages.findIndex(player => player.imageURL && player.imageURL.includes('Cards/Icons/'));
                    storedImages.splice(index, 1);
                }

                // Reward the user with an image (replace 'rewardImageURL' with your image URL)
                const rewardImageURL = 'Cards/sbc/messiflashback.png';
                storedImages.push({ name: `${challengeName} Reward`, imageURL: rewardImageURL });

                // Update the player collection in local storage
                updatePlayerCollection();

                // Display the reward image
                displayRewardImage(rewardImageURL);

                // Display a success message (you can improve this part)
                alert(`SBC Challenge "${challengeName}" completed! You received a reward.`);
            } else {
                // Display an error message if the user doesn't meet the requirements
                alert(`You don't have enough ICON players to complete "${challengeName}".`);
            }

            // Refresh the UI to reflect the changes
            displayPlayerCollection();
        }

        // Function to display the reward image
        function displayRewardImage(imageURL) {
            const rewardContainer = document.getElementById('reward-container');
            const rewardImage = document.getElementById('reward-image');
            
            // Set the source and display the reward container
            rewardImage.src = imageURL;
            rewardContainer.style.display = 'block';
        }

        // Function to display the user's player collection
        function displayPlayerCollection() {
            const playerCollectionList = document.getElementById('player-collection');
            
            // Check if the element exists before manipulating it
            if (playerCollectionList) {
                playerCollectionList.innerHTML = '';

                storedImages.forEach((player) => {
                    if (player.imageURL) {
                        const listItem = document.createElement('li');
                        const image = document.createElement('img');
                        image.src = player.imageURL;
                        listItem.appendChild(image);
                        playerCollectionList.appendChild(listItem);
                    }
                });
            }
        }

        // Initialize the UI with the user's player collection
        displayPlayerCollection();
    </script>
</body>
</html>
